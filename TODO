
Update court.details_updated_at when anything changes in:


** addresses - done
** contacts - done
** court_facilities - done
** court_types_courts
** courts - done
** emails
** opening_times
** postcode_courts
** remits


install redis

install sidekiq gem


create workers/gov_uk_push_worker.rb

class GovUkPushWorker
  include Sidekiq::Worker

  def perform(court_id)
    CourtSerializer ......
  end
end

Then in the GovUkPushable concern, GovUkWorker.perform_async(court_id)


Serializer.

 - instantiate the court
 - serialize everything
 - validate against schema
 - create md5
 - compare with last md5
 - push to gov uk
 - check response
 - update court with new md5 if successful

 

TEst that when an address/contact etc is destroyed, a gov uk court update job is triggered



ENDPOINTS:

GDS:  https://courts-api.preview.alphagov.co.uk/court/[uuid]
MF:   https://safe-garden-8494.herokuapp.com/court/[UUID]